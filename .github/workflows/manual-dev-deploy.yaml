  name: Manual Dev Deploy
  on:
    workflow_dispatch:
  jobs:
    deploy_dev:
      runs-on: ubuntu-latest
      environment: Dev
      steps:
        - name: checkout code
          uses: actions/checkout@v2
        - name: Deploy to Gov PaaS
          uses: citizen-of-planet-earth/cf-cli-action@v2
          with:
            cf_api:      ${{secrets.CF_API}}
            cf_org:      ${{secrets.CF_ORG}}
            cf_space:    ${{secrets.CF_SPACE }}
            cf_username: ${{secrets.CF_USER}}
            cf_password: ${{secrets.CF_PASSWORD}}
            command: push funding-service-design-application-store-dev
        - name: Apply network policy for notification service
          uses: citizen-of-planet-earth/cf-cli-action@v2
          with:
            cf_api:      ${{secrets.CF_API}}
            cf_org:      ${{secrets.CF_ORG}}
            cf_space:    ${{secrets.CF_SPACE }}
            cf_username: ${{secrets.CF_USER}}
            cf_password: ${{secrets.CF_PASSWORD}}
            command: add-network-policy funding-service-design-application-store-dev funding-service-design-notification-dev --protocol tcp --port 8080  
